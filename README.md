# Xcards

![coverage][coverage_badge]
[![style: very good analysis][very_good_analysis_badge]][very_good_analysis_link]
[![License: MIT][license_badge]][license_link]

A Flutter application for **spaced repetition learning using flashcards** - created as a certification project for [10xDevs](https://www.10xdevs.pl/).

## About This Project ğŸ“–

**Xcards** is a mobile application designed to help users learn effectively through the spaced repetition technique. The app allows users to create, manage, and study flashcards optimized for long-term memory retention.

### ğŸ“ 10xDevs Certification Project

This project is being developed as part of the 10xDevs certification program, demonstrating proficiency in using AI to deliver apps quicker!

### ğŸ“š Additional Context

For AI agents and developers working on this project:
- **Architecture & Coding Rules**: See `.cursor/rules/` directory for comprehensive guidelines
- **Quick Reference**: `.cursor/rules/README.md` contains key concepts and examples
- **Tech Stack**: Flutter, Dart, BLoC/Cubit, auto_route, get_it, freezed, retrofit, flutter_screenutil
- **Localization**: English (en) and Polish (pl) languages supported

Generated by the [Very Good CLI][very_good_cli_link] ğŸ¤–

---

## Project Architecture ğŸ—ï¸

This project follows **Clean Architecture** principles with strict layer separation:

### Layer Structure

```
lib/
â”œâ”€â”€ app/                    # Application-wide configurations
â”‚   â”œâ”€â”€ config/            # DI, networking, database setup
â”‚   â”œâ”€â”€ constants/         # App-wide constants
â”‚   â””â”€â”€ failures/          # Error handling (AppFailure)
â”œâ”€â”€ presentation/          # Shared UI components
â”‚   â”œâ”€â”€ common_widgets/    # Reusable widgets
â”‚   â”œâ”€â”€ routing/          # Auto Route configuration
â”‚   â””â”€â”€ styles/           # AppDimensions, AppColors, AppTextStyles
â””â”€â”€ features/             # Feature modules
    â””â”€â”€ {feature}/
        â”œâ”€â”€ data/         # DTOs, API clients, services
        â”œâ”€â”€ domain/       # Models, use cases (business logic)
        â””â”€â”€ presentation/ # Cubits, pages, views, widgets
```

### Key Architectural Decisions

- **State Management**: BLoC pattern with Cubit
- **Dependency Injection**: get_it with injectable for automatic registration
- **Navigation**: auto_route for type-safe routing
- **Immutability**: freezed for all data classes
- **Error Handling**: Centralized AppFailure instead of exceptions
- **Responsive Design**: flutter_screenutil with AppDimensions (no magic numbers)
- **Localization**: ARB files with context-based access (no hardcoded strings)

### Development Guidelines

All code should follow the rules defined in `.cursor/rules/`:
- **shared.mdc** - Architecture, tech stack, global patterns
- **page.mdc** - UI layer (Pages, Views, Widgets)
- **cubit.mdc** - State management (Cubits, States)
- **service.mdc** - Data layer (Services, DTOs, API clients)
- **l10n.mdc** - Localization guidelines
- **testing.mdc** - Testing patterns and mocking strategies

---

## Getting Started ğŸš€

This project contains 3 flavors:

- development
- staging
- production

To run the desired flavor either use the launch configuration in VSCode/Android Studio or use the following commands:

```sh
# Development
$ flutter run --flavor development --target lib/main_development.dart

# Staging
$ flutter run --flavor staging --target lib/main_staging.dart

# Production
$ flutter run --flavor production --target lib/main_production.dart
```

_\*Xcards works on iOS, Android, Web, and Windows._

---

## Running Tests ğŸ§ª

This project emphasizes comprehensive testing with high coverage targets:
- Domain layer (use cases, models): 90%+
- Presentation layer (cubits, states): 85%+
- Data layer (services): 80%+
- UI layer (pages, views): 70%+

### Run All Tests

```sh
$ flutter test
```

Or with Very Good CLI:

```sh
$ very_good test --coverage --test-randomize-ordering-seed random
```

### Run Specific Test Suites

```sh
# Run tests for a specific feature
$ flutter test test/features/counter/

# Run tests with coverage
$ flutter test --coverage

# Run specific test file
$ flutter test test/features/counter/presentation/cubit/counter_cubit_test.dart
```

### View Coverage Report

To view the generated coverage report you can use [lcov](https://github.com/linux-test-project/lcov).

```sh
# Generate Coverage Report
$ genhtml coverage/lcov.info -o coverage/

# Open Coverage Report
$ open coverage/index.html
```

### Testing Guidelines

- All tests use **mocktail** for mocking dependencies
- Widget tests use **PumpApp** helper from `test/helpers/pump_app.dart`
- Cubit tests use **blocTest** from bloc_test package
- Pages that use GetIt require mock registration in `setUp()` and cleanup in `tearDown()`
- See `.cursor/rules/testing.mdc` for comprehensive testing patterns

---

## Code Generation ğŸ”¨

This project uses several code generation tools. After creating or modifying certain files, run:

### Generate Freezed, Injectable, Retrofit, Auto Route

```sh
# Full regeneration (recommended after changes)
$ dart run build_runner build --delete-conflicting-outputs

# Watch mode (regenerates on file changes)
$ dart run build_runner watch --delete-conflicting-outputs
```

This generates:
- `.freezed.dart` files for immutable models and states
- `.g.dart` files for JSON serialization
- `.g.dart` files for Retrofit API clients
- `.config.dart` for injectable dependency injection
- `.gr.dart` for auto_route navigation

### Generate Localizations

```sh
$ flutter gen-l10n --arb-dir="lib/l10n/arb"
```

This generates `app_localizations*.dart` files for all supported locales.

**Note**: Run code generation after:
- Creating/modifying freezed classes (models, states, DTOs)
- Adding/changing injectable annotations
- Modifying Retrofit API clients
- Updating auto_route pages
- Changing ARB localization files

---

## Working with Translations ğŸŒ

This project relies on [flutter_localizations][flutter_localizations_link] and follows the [official internationalization guide for Flutter][internationalization_link].

**Supported Languages**: English (en), Polish (pl)

### Adding Strings

1. To add a new localizable string, open the `app_en.arb` file at `lib/l10n/arb/app_en.arb`.

```arb
{
    "@@locale": "en",
    "@@@____COUNTER___START": {},
    "counterAppBarTitle": "Counter",
    "@counterAppBarTitle": {
        "description": "Text shown in the AppBar of the Counter Page"
    },
    "@@@____COUNTER___END": {}
}
```

**Note**: Use section markers (`@@@____FEATURE___START/END`) to organize strings by feature.

2. Then add a new key/value and description

```arb
{
    "@@locale": "en",
    "@@@____COUNTER___START": {},
    "counterAppBarTitle": "Counter",
    "@counterAppBarTitle": {
        "description": "Text shown in the AppBar of the Counter Page"
    },
    "helloWorld": "Hello World",
    "@helloWorld": {
        "description": "Hello World Text"
    },
    "@@@____COUNTER___END": {}
}
```

3. Use the new string

```dart
import 'package:xcards/l10n/l10n.dart';

@override
Widget build(BuildContext context) {
  final l10n = context.l10n;
  return Text(l10n.helloWorld);
}
```

**Important**: Never hardcode user-facing strings - always use `context.l10n`!

### Adding Supported Locales

Update the `CFBundleLocalizations` array in the `Info.plist` at `ios/Runner/Info.plist` to include the new locale.

```xml
    ...

    <key>CFBundleLocalizations</key>
	<array>
		<string>en</string>
		<string>pl</string>
	</array>

    ...
```

### Adding Translations

1. For each supported locale, add a new ARB file in `lib/l10n/arb`.

```
â”œâ”€â”€ l10n
â”‚   â”œâ”€â”€ arb
â”‚   â”‚   â”œâ”€â”€ app_en.arb
â”‚   â”‚   â””â”€â”€ app_pl.arb
```

2. Add the translated strings to each `.arb` file:

`app_en.arb`

```arb
{
    "@@locale": "en",
    "@@@____COUNTER___START": {},
    "counterAppBarTitle": "Counter",
    "@counterAppBarTitle": {
        "description": "Text shown in the AppBar of the Counter Page"
    },
    "@@@____COUNTER___END": {}
}
```

`app_pl.arb`

```arb
{
    "@@locale": "pl",
    "@@@____COUNTER___START": {},
    "counterAppBarTitle": "Licznik",
    "@counterAppBarTitle": {
        "description": "Tekst wyÅ›wietlany w AppBar strony Licznika"
    },
    "@@@____COUNTER___END": {}
}
```

### Generating Translations

To use the latest translations changes, you will need to generate them:

1. Generate localizations for the current project:

```sh
flutter gen-l10n --arb-dir="lib/l10n/arb"
```

Alternatively, run `flutter run` and code generation will take place automatically.

For more details, see `.cursor/rules/l10n.mdc`.

---

## For Developers & AI Agents ğŸ¤–

### Quick Start for Contributors

1. **Read the Architecture Rules**: All development guidelines are in `.cursor/rules/`
   - Start with `.cursor/rules/README.md` for an overview
   - Reference specific rule files based on what you're working on

2. **Key Principles** (Never violate these):
   - âŒ No magic numbers â†’ âœ… Use `AppDimensions`
   - âŒ No hardcoded strings â†’ âœ… Use `context.l10n`
   - âŒ No throwing exceptions â†’ âœ… Use `AppFailure`
   - âŒ No logic in Views â†’ âœ… Keep it in Cubits/UseCases
   - âŒ No direct instantiation â†’ âœ… Use dependency injection

3. **Before Committing**:
   ```sh
   # Run code generation
   dart run build_runner build --delete-conflicting-outputs
   flutter gen-l10n --arb-dir="lib/l10n/arb"
   
   # Run tests
   flutter test
   
   # Check for issues
   flutter analyze
   ```

### Project Structure Quick Reference

```
lib/
â”œâ”€â”€ app/                  # App config, DI, failures, constants
â”œâ”€â”€ presentation/         # Shared UI (common_widgets, styles, routing)
â””â”€â”€ features/
    â””â”€â”€ {feature}/
        â”œâ”€â”€ data/         # DTOs, services, API clients
        â”œâ”€â”€ domain/       # Models, use cases (business logic)
        â””â”€â”€ presentation/ # Cubits, pages, views, widgets

test/
â”œâ”€â”€ features/            # Mirrors lib/features structure
â””â”€â”€ helpers/             # Test utilities (pump_app, etc.)
```

### Common Commands

```sh
# Run with specific flavor
flutter run --flavor development --target lib/main_development.dart

# Generate code (freezed, injectable, retrofit, routes)
dart run build_runner build --delete-conflicting-outputs

# Generate localizations
flutter gen-l10n --arb-dir="lib/l10n/arb"

# Run tests with coverage
flutter test --coverage

# Analyze code
flutter analyze

# Format code
dart format .
```

### Resources

- **Project Rules**: `.cursor/rules/README.md`
- **Testing Guide**: `.cursor/rules/testing.mdc`
- **Clean Architecture**: Domain â†’ Data â†’ Presentation
- **10xDevs Certification**: [https://www.10xdevs.pl/](https://www.10xdevs.pl/)

---

[coverage_badge]: coverage_badge.svg
[flutter_localizations_link]: https://api.flutter.dev/flutter/flutter_localizations/flutter_localizations-library.html
[internationalization_link]: https://flutter.dev/docs/development/accessibility-and-localization/internationalization
[license_badge]: https://img.shields.io/badge/license-MIT-blue.svg
[license_link]: https://opensource.org/licenses/MIT
[very_good_analysis_badge]: https://img.shields.io/badge/style-very_good_analysis-B22C89.svg
[very_good_analysis_link]: https://pub.dev/packages/very_good_analysis
[very_good_cli_link]: https://github.com/VeryGoodOpenSource/very_good_cli
